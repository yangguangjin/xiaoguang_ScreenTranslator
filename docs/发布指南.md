# 发布新版本指南

## 前置条件

- 已安装 [GitHub CLI](https://cli.github.com/)
- 已登录 GitHub：`gh auth login`
- 如需代理，先设置环境变量：
  ```bash
  export https_proxy=http://127.0.0.1:6789
  ```

## 发布步骤

### 1. 打包程序

跨平台版本（Avalonia）需要分别为每个平台打包：

```bash
# Windows
dotnet publish ScreenTranslator.Desktop -c Release -r win-x64 --self-contained -o output/win-x64

# macOS Intel
dotnet publish ScreenTranslator.Desktop -c Release -r osx-x64 --self-contained -o output/osx-x64

# macOS Apple Silicon
dotnet publish ScreenTranslator.Desktop -c Release -r osx-arm64 --self-contained -o output/osx-arm64
```

将各平台输出目录分别压缩为 zip 文件：

```
output/ScreenTranslator-win-x64-1.1.0.zip
output/ScreenTranslator-osx-x64-1.1.0.zip
output/ScreenTranslator-osx-arm64-1.1.0.zip
```

### 2. 创建 Release 并上传

```bash
gh release create v1.1.0 \
  output/ScreenTranslator-win-x64-1.1.0.zip \
  output/ScreenTranslator-osx-x64-1.1.0.zip \
  output/ScreenTranslator-osx-arm64-1.1.0.zip \
  --repo yangguangjin/xiaoguang_ScreenTranslator \
  --title "小光翻译 v1.1.0" \
  --notes "版本更新说明"
```

参数说明：
- `v1.1.0` — Tag 名称，按版本号递增
- 多个 zip 文件对应不同平台
- `--title` — Release 标题
- `--notes` — 更新说明（支持 Markdown）

### 3. 多行更新说明

如果更新说明较长，可以用 `--notes-file` 从文件读取：

```bash
gh release create v1.1.0 output/ScreenTranslator-1.1.0.zip \
  --repo yangguangjin/xiaoguang_ScreenTranslator \
  --title "小光翻译 v1.1.0" \
  --notes-file CHANGELOG.md
```

## 其他常用命令

```bash
# 查看所有 Release
gh release list --repo yangguangjin/xiaoguang_ScreenTranslator

# 删除某个 Release
gh release delete v1.0.0 --repo yangguangjin/xiaoguang_ScreenTranslator

# 向已有 Release 追加文件
gh release upload v1.0.0 output/另一个文件.zip \
  --repo yangguangjin/xiaoguang_ScreenTranslator

# 编辑已有 Release 的说明
gh release edit v1.0.0 --notes "新的说明" \
  --repo yangguangjin/xiaoguang_ScreenTranslator
```
